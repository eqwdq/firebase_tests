<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css"> -->

</head>
<body>


    <!-- <div class="col-12 col-sm-6 col-xl-2 col-md-4 col-lg-3">
        <div class="card shadow-sm bg-light mb-2">
            <img src="" class="img-fluid shop-item-image" id="productImg" alt="">
            <div class="card-body text-center">
                <h6 class="shop-item-title" id="shop-item-title"></h6>
                <p class="card-text" id="card-text"></p>
                <div>
                    <small class="text-muted float-start">Skladom 5+ ks</small>
//                    <i class="bi bi-star-fill float-end"></i>
//                    <i class="bi bi-star-fill float-end"></i>
//                    <i class="bi bi-star-fill float-end"></i>
//                    <i class="bi bi-star-fill float-end"></i>
                    <small class="text-muted float-end" id="rating"></small>
                </div>
            </div>
            <div class="card-footer shop-item-details">
                <p class="float-start top shop-item-price" id="shop-item-price"></p>
                <button class="btn btn-outline-dark float-end shop-item-button">Do košíka</button>
            </div>
        </div>
    </div> -->
    <div class="cart-items">
    </div>

    <!-- kod nad poslanie dat na backend admin page -->
    <!-- <input type="text" placeholder="meno produktu" id="inputName"> <br> <br>
    <input type="text" placeholder="popis produktu" id="inputDescription"> <br> <br>
    <input type="text" placeholder="cena produktu" id="inputPrice"> <br> <br>
    <input type="text" placeholder="hodnotenie produktu" id="inputRating"> <br> <br>
    <button id="inputSubmit">Odoslat</button> -->

    <script type="module">

        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-analytics.js";
        import { getFirestore, doc, getDoc, getDocs, onSnapshot, collection, setDoc } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-firestore.js";
        import { getStorage, ref as sRef, uploadBytesResumable, getDownloadURL, listAll, ref } from "https://www.gstatic.com/firebasejs/9.6.6/firebase-storage.js";


        const firebaseConfig = {
            apiKey: "AIzaSyCI5SdwdXMQeu3y7AQPZnkcZH_GmIcSgKw",
            authDomain: "login-9a8b6.firebaseapp.com",
            databaseURL: "https://login-9a8b6-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "login-9a8b6",
            storageBucket: "login-9a8b6.appspot.com",
            messagingSenderId: "663312681266",
            appId: "1:663312681266:web:aaff10c5e0a58994ceaf2b",
            measurementId: "G-XTC30ZEDBX"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore();


        // var stdNo = 0;
        // var tbody = document.getElementById('tbody1');

        // function addItem(name,roll,sec,gen) {
        //     let trow = document.createElement("tr");
        //     let td1 = document.createElement('td');
        //     let td2 = document.createElement('td');
        //     let td3 = document.createElement('td');
        //     let td4 = document.createElement('td');
        //     let td5 = document.createElement('td');

        //     td1.innerHTML= ++stdNo;
        //     td2.innerHTML= name;
        //     td3.innerHTML= roll;
        //     td4.innerHTML= sec;
        //     td5.innerHTML= gen;

        //     trow.appendChild(td1);
        //     trow.appendChild(td2);
        //     trow.appendChild(td3);
        //     trow.appendChild(td4);
        //     trow.appendChild(td5);

        //     tbody.appendChild(trow);
        // }

        function addContentFromFirebase(name, price, rating, description, ImageURL) {

            // var htmlName = document.getElementById('shop-item-title');
            // var htmlPrice = document.getElementById('shop-item-price');
            // var htmlRating = document.getElementById('rating');
            // var htmlDescription = document.getElementById('card-text');
            // var htmlProductImage = document.getElementById('productImg');

            // htmlName.innerHTML = name;
            // htmlPrice.innerHTML = price + '€';
            // htmlRating.innerHTML = rating;
            // htmlDescription.innerHTML = description;
            // htmlProductImage.src = ImageURL;

            var cartRow = document.createElement('div')
            var cartItems = document.getElementsByClassName('cart-items')[0]
            var cartRowContents = `
            <div class="col-12 col-sm-6 col-xl-2 col-md-4 col-lg-3">
                <div class="card shadow-sm bg-light mb-2">
                    <img src="${ImageURL}" class="img-fluid shop-item-image" id="productImg" alt="">
                    <div class="card-body text-center">
                        <h6 class="shop-item-title" id="shop-item-title">${name}</h6>
                        <p class="card-text" id="card-text">${description}</p>
                        <div>
                            <small class="text-muted float-start">Skladom 5+ ks</small>
                            <small class="text-muted float-end" id="rating">${rating}</small>
                        </div>
                    </div>
                    <div class="card-footer shop-item-details">
                        <p class="float-start top shop-item-price" id="shop-item-price">${price} €</p>
                        <button class="btn btn-outline-dark float-end shop-item-button">Do košíka</button>
                    </div>
                </div>
            </div>
            `
            cartRow.innerHTML = cartRowContents
            cartItems.append(cartRow)


            // tablerow.appendChild(t1);

            // tbody.appendChild(tablerow);
        }

        // function addAllItems(theStudent) {
        //     theStudent.forEach(element => {
        //         addItem(element.nameOfStd, element.rollNo, element.section, element.gender);});}
        function addFromFirebase(items) {

            items.forEach(element => {
                addContentFromFirebase(element.name, element.price, element.rating, element.description, element.ImageURL);

            });

        }




        // async function getData(){
        //     const dataSnapshot = await getDocs(collection(db, "metadata"));
        //     var items = [];

        //     dataSnapshot.forEach(doc => {
        //         items.push(doc.data());
        //     });
        //     addFromFirebase(items);
        // }
        // window.onload = getData;



        // async function getImageFromFirestore(){
        //     // var name = imgname.value;

        //     var ref = doc(db, "ImageLinks/luca-zanon-26595-unsplash");
        //     const docSnap = await getDoc(ref);

        //     if(docSnap.exists()){
        //         productImg.src = docSnap.data().ImageURL;
        //     }
        // }







    function onloadWindow() {
        getFromFirebase();
        // getImageFromFirestore();
    }

    // async function getFromFirebase(){
    //     const dfRef = collection(db, "metadata");

    //     onSnapshot(dfRef,(querySnapshot) => {
    //         var items = [];

    //         querySnapshot.forEach(doc => {
    //             items.push(doc.data());
    //         });
    //         addFromFirebase(items);
    //     })
    // }

    async function getFromFirebase(){
        const querySnapshot = await getDocs(collection(db, "metadata"));

        var items = [];

        querySnapshot.forEach(doc => {
            items.push(doc.data());
        });
        addFromFirebase(items);
    }


    // NOTE this is not needed if you use firestore database, storage is needed only for the imageURL

    // async function getImageFromFirestore(){
    //     // var name = imgname.value;

    //     var ref = doc(db, "ImageLinks/" + ImageURL);
    //     const docSnap = await getDoc(ref);

    //     if(docSnap.exists()){
    //         // productImg.src = docSnap.data().ImageURL;
    //     }
    // }

    const storage = getStorage();


    window.onload = onloadWindow;


    </script>
</body>
</html>